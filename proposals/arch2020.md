# Architecture for Selection and Authentication

This is a draft for discussion. Questions? Ian Jacobs or Adrian Hope-Bailie.

## Introduction

One design goal of Payment Request API is to streamline checkout by making it easy for users to reuse stored payment credentials.

In the past year the Web Payments Working Group has also turned its attention to the smooth integration of strong customer authentication (SCA) into Payment Request, notably using Web Authentication.

The current document intends to support discussion of a flexible architecture that enables browsers to support a variety of use cases.

## Capabilities

* Modal windows
  * Display origin of content
  * May have 1p storage access (possibly with some constraints)
  * Can be created by payment app or merchant (new!)
* Payment Method Selection
  * Filtering and sorting of payment apps based on what payment methods the merchant accepts
  * May be further streamlined by skip-the-sheet behavior
* Credential registration in the browser  
  * Display, filtering and sorting, selection of instruments based on what payment methods the merchant accepts
  * Owning parties (e.g., payment app or PSP in iframe) can access payment credentials in a payment request context.
  * May be further streamlined by "default instrument" settings in the browser
  * May be useful to scope hasEnrolledInstrument type functionality (owning party knows answer; other origins don't).
* Streamlined authentication
  * This is a goal of SPC

## Use Cases

These features might be used as following in different use cases:


|                     | Merchant modal | Payment app modal | Payment Method Selection | Browser credential selector | Streamlined authentication | 
|---------------------|----------------|-------------------|-----------------------------|-----|-----|
| *Pay (one PMI)      |                |         Yes         |      (skip the sheet) |     |    | 
| Multiple PMIs       |                |         Yes         |              Yes    |          |     |
| Form fill + 3DS     |      Yes (OTP)   |                   |              |               |  Yes  |
| SRC via payment app |                |         Yes         |  (skip the sheet) |               |  Maybe   | 
| SRC via browser     |      Yes         |                   |         |     Yes              |  Yes  |
| PayPal static creds | Yes |      |      |     Yes   | Yes |

# Considerations

* What is appetite to use Web services v. traditional rails?
* Can browser ping server periodically to get fresh credentials or rotate identifiers?